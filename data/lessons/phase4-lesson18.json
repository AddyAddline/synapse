{
  "phase": 4,
  "order_num": 4,
  "title": "Meditation & Brain Waves",
  "description": "Analyze brain wave patterns during meditation — alpha and theta power changes, and comparing meditation to rest conditions.",
  "difficulty": "advanced",
  "estimated_minutes": 45,
  "content_md": "# Meditation & Brain Waves\n\nThis lesson is the heart of why you started learning MATLAB. Your friend studies how yoga and meditation affect the brain, and this is **exactly** the kind of analysis they do every day.\n\nWhen someone sits quietly and meditates, their brain waves change in measurable ways. Understanding these changes is one of the most active areas in contemplative neuroscience.\n\n## Brain Wave Frequency Bands\n\nNeural oscillations are categorized into frequency bands, each associated with different mental states:\n\n| Band | Frequency | Associated With |\n|---|---|---|\n| **Delta** | 0.5 - 4 Hz | Deep sleep |\n| **Theta** | 4 - 8 Hz | Drowsiness, deep meditation, memory |\n| **Alpha** | 8 - 13 Hz | Relaxed wakefulness, eyes closed, meditation |\n| **Beta** | 13 - 30 Hz | Active thinking, focus, anxiety |\n| **Gamma** | 30 - 100 Hz | Higher cognition, experienced meditators |\n\n## What Happens During Meditation?\n\nDecades of research have shown consistent patterns:\n\n### Alpha Power Increases\nThe most robust finding: **alpha waves (8-13 Hz) increase during meditation**, especially in parietal and occipital regions. Alpha is associated with a calm, relaxed but alert state — exactly what meditators report experiencing.\n\n### Theta Waves During Deep Meditation\nExperienced meditators often show increased **theta activity (4-8 Hz)**, particularly in frontal regions. Theta is linked to the deeply internalized, contemplative state.\n\n### Reduced Beta Activity\nDuring meditation, **beta waves often decrease**, reflecting reduced analytical thinking and mental chatter.\n\n### Gamma in Experienced Meditators\nLong-term meditators (like Buddhist monks with thousands of hours of practice) have shown extraordinary increases in **gamma activity**, suggesting heightened awareness.\n\n## How to Measure These Changes\n\nThe key technique is **power spectral analysis** — computing how much power (energy) is present at each frequency.\n\n```matlab\n% Compute power spectrum using FFT\nN = length(signal);\nfft_result = fft(signal);\npower_spectrum = (abs(fft_result(1:N/2+1)).^2) / N;\nfreqs = (0:N/2) * fs / N;\n```\n\nTo get **band power** (e.g., total alpha power):\n\n```matlab\nalpha_idx = freqs >= 8 & freqs <= 13;\nalpha_power = sum(power_spectrum(alpha_idx));\n```\n\n## Comparing Conditions\n\nIn a typical meditation study:\n1. Record EEG during a **baseline/rest** period (eyes open or closed, not meditating)\n2. Record EEG during **meditation**\n3. Compare the power spectra between conditions\n\nA common measure is the **relative power change**:\n\n```matlab\nchange_pct = (meditation_power - rest_power) / rest_power * 100;\n```\n\nIf alpha power increases by 40-60% during meditation compared to rest, that is a strong and meaningful effect.\n\n## Personal Connection\n\nImagine your friend recording EEG from participants before and during a meditation session. The participant sits comfortably, electrodes on their scalp, and begins a guided meditation. Your friend's analysis pipeline extracts the alpha power and shows that beautiful increase — a window into the meditative brain state.\n\nThe exercises below let you build exactly that analysis.",
  "exercises": [
    {
      "order_num": 1,
      "title": "Calculate alpha power from simulated EEG",
      "prompt": "Simulate an EEG signal with known frequency components and extract the alpha band (8-13 Hz) power using the FFT.\n\nSteps:\n1. Use rng(33). Set fs = 256, duration = 4 seconds.\n2. Create a signal with:\n   - Alpha component: 20*sin(2*pi*10*t) (10 Hz, amplitude 20)\n   - Beta component: 5*sin(2*pi*25*t) (25 Hz, amplitude 5)\n   - Noise: 3*randn\n3. Compute the FFT and single-sided power spectrum\n4. Create the frequency vector\n5. Extract alpha power: sum of power where 8 <= freq <= 13\n6. Extract total power: sum of all power\n7. Compute relative alpha power (alpha_power / total_power * 100)\n\nDisplay: total power (rounded to nearest integer), alpha power (rounded to nearest integer), relative alpha power (rounded to 1 decimal, with percent sign).",
      "starter_code": "% Alpha power calculation\nrng(33);\n\nfs = 256;\nduration = 4;\nt = 0:1/fs:duration-1/fs;\nN = length(t);\n\n% Create signal\nalpha_component = 20 * sin(2*pi*10*t);\nbeta_component = 5 * sin(2*pi*25*t);\nnoise = 3 * randn(1, N);\nsignal = alpha_component + beta_component + noise;\n\n% Compute FFT and power spectrum\n% YOUR CODE HERE\n\n% Frequency vector\n% YOUR CODE HERE\n\n% Alpha power (8-13 Hz)\n% YOUR CODE HERE\n\n% Total power\n% YOUR CODE HERE\n\n% Relative alpha power\n% YOUR CODE HERE\n\n% Display\n% YOUR CODE HERE\n",
      "solution": "rng(33);\n\nfs = 256;\nduration = 4;\nt = 0:1/fs:duration-1/fs;\nN = length(t);\n\nalpha_component = 20 * sin(2*pi*10*t);\nbeta_component = 5 * sin(2*pi*25*t);\nnoise = 3 * randn(1, N);\nsignal = alpha_component + beta_component + noise;\n\nfft_result = fft(signal);\npower_spectrum = (abs(fft_result(1:N/2+1)).^2) / N;\nfreqs = (0:N/2) * fs / N;\n\nalpha_idx = freqs >= 8 & freqs <= 13;\nalpha_power = sum(power_spectrum(alpha_idx));\n\ntotal_power = sum(power_spectrum);\n\nrelative_alpha = alpha_power / total_power * 100;\n\ndisp(['Total power: ' num2str(round(total_power))]);\ndisp(['Alpha power: ' num2str(round(alpha_power))]);\ndisp(['Relative alpha power: ' num2str(round(relative_alpha*10)/10) '%']);",
      "hints": [
        "FFT: fft_result = fft(signal); Power: power_spectrum = (abs(fft_result(1:N/2+1)).^2) / N; Frequency: freqs = (0:N/2) * fs / N;",
        "Alpha indices: alpha_idx = freqs >= 8 & freqs <= 13; Alpha power: alpha_power = sum(power_spectrum(alpha_idx));",
        "Total power: total_power = sum(power_spectrum); Relative: relative_alpha = alpha_power / total_power * 100; Display with round."
      ],
      "test_cases": [
        {
          "expected_output": "Total power: 213\nAlpha power: 195\nRelative alpha power: 91.8%\n"
        }
      ],
      "requires_plot": false
    },
    {
      "order_num": 2,
      "title": "Compare alpha power: meditation vs rest",
      "prompt": "Simulate two EEG conditions and compare their alpha power — just like a real meditation study.\n\n**Rest condition:** Lower alpha (amplitude 8), higher beta (amplitude 12), noise std 4\n**Meditation condition:** Higher alpha (amplitude 22), lower beta (amplitude 4), noise std 3\n\nBoth signals: 10 Hz for alpha, 20 Hz for beta, also add a 6 Hz theta component with amplitude 10 in meditation and amplitude 3 at rest.\n\nSteps:\n1. Use rng(55). Set fs = 256, duration = 5 seconds.\n2. Generate rest signal: 8*sin(2*pi*10*t) + 12*sin(2*pi*20*t) + 3*sin(2*pi*6*t) + 4*randn\n3. Generate meditation signal: 22*sin(2*pi*10*t) + 4*sin(2*pi*20*t) + 10*sin(2*pi*6*t) + 3*randn\n4. Compute power spectra for both\n5. Extract alpha (8-13 Hz) power for both conditions\n6. Calculate percentage change: (meditation - rest) / rest * 100\n\nDisplay: rest alpha power (rounded to nearest integer), meditation alpha power (rounded to nearest integer), and the percentage change (rounded to 1 decimal, with percent sign).",
      "starter_code": "% Meditation vs rest alpha power comparison\nrng(55);\n\nfs = 256;\nduration = 5;\nt = 0:1/fs:duration-1/fs;\nN = length(t);\n\n% Generate rest condition signal\n% YOUR CODE HERE\n\n% Generate meditation condition signal\n% YOUR CODE HERE\n\n% Compute power spectra for both\n% YOUR CODE HERE\n\n% Extract alpha power (8-13 Hz)\n% YOUR CODE HERE\n\n% Calculate percentage change\n% YOUR CODE HERE\n\n% Display results\n% YOUR CODE HERE\n",
      "solution": "rng(55);\n\nfs = 256;\nduration = 5;\nt = 0:1/fs:duration-1/fs;\nN = length(t);\n\nrest_signal = 8*sin(2*pi*10*t) + 12*sin(2*pi*20*t) + 3*sin(2*pi*6*t) + 4*randn(1, N);\nmed_signal = 22*sin(2*pi*10*t) + 4*sin(2*pi*20*t) + 10*sin(2*pi*6*t) + 3*randn(1, N);\n\nfft_rest = fft(rest_signal);\npower_rest = (abs(fft_rest(1:N/2+1)).^2) / N;\n\nfft_med = fft(med_signal);\npower_med = (abs(fft_med(1:N/2+1)).^2) / N;\n\nfreqs = (0:N/2) * fs / N;\nalpha_idx = freqs >= 8 & freqs <= 13;\n\nalpha_rest = sum(power_rest(alpha_idx));\nalpha_med = sum(power_med(alpha_idx));\n\npct_change = (alpha_med - alpha_rest) / alpha_rest * 100;\n\ndisp(['Rest alpha power: ' num2str(round(alpha_rest))]);\ndisp(['Meditation alpha power: ' num2str(round(alpha_med))]);\ndisp(['Alpha power change: ' num2str(round(pct_change*10)/10) '%']);",
      "hints": [
        "Build each signal by summing sine waves and noise. rest_signal = 8*sin(2*pi*10*t) + 12*sin(2*pi*20*t) + 3*sin(2*pi*6*t) + 4*randn(1, N);",
        "Compute FFT and power for both: fft_rest = fft(rest_signal); power_rest = (abs(fft_rest(1:N/2+1)).^2)/N; Same for meditation. freqs = (0:N/2)*fs/N;",
        "Alpha indices: alpha_idx = freqs >= 8 & freqs <= 13; alpha_rest = sum(power_rest(alpha_idx)); Percentage change: (alpha_med - alpha_rest)/alpha_rest * 100."
      ],
      "test_cases": [
        {
          "expected_output": "Rest alpha power: 41\nMeditation alpha power: 303\nAlpha power change: 639.1%\n"
        }
      ],
      "requires_plot": false
    },
    {
      "order_num": 3,
      "title": "Visualize brain wave changes during meditation",
      "prompt": "Create a visualization showing how brain wave power changes over the course of a meditation session.\n\nSimulate a 60-second recording divided into three 20-second phases:\n- Phase 1 (0-20s): Rest — alpha amplitude 8, theta amplitude 3\n- Phase 2 (20-40s): Early meditation — alpha amplitude 16, theta amplitude 8\n- Phase 3 (40-60s): Deep meditation — alpha amplitude 24, theta amplitude 15\n\nAll phases also include: beta at amplitude 6 (20 Hz) and noise with std 3.\n\nSteps:\n1. Use rng(44). Set fs = 256.\n2. Build the signal in three segments concatenated together.\n3. Compute power spectra in 4-second sliding windows (non-overlapping, so 15 windows total).\n4. For each window, compute alpha (8-13 Hz) and theta (4-8 Hz) power.\n5. Create a 2-subplot figure:\n   - Top: alpha power over time (window number)\n   - Bottom: theta power over time (window number)\n   Add appropriate labels and titles. Main title: 'Brain Wave Changes During Meditation'",
      "starter_code": "% Meditation brain wave changes over time\nrng(44);\n\nfs = 256;\nphase_duration = 20;  % seconds each\n\n% Phase 1: Rest\nt1 = 0:1/fs:phase_duration-1/fs;\nphase1 = 8*sin(2*pi*10*t1) + 3*sin(2*pi*6*t1) + 6*sin(2*pi*20*t1) + 3*randn(1,length(t1));\n\n% Phase 2: Early meditation\n% YOUR CODE HERE\n\n% Phase 3: Deep meditation\n% YOUR CODE HERE\n\n% Concatenate\n% YOUR CODE HERE\n\n% Sliding window analysis (4-second windows)\nwindow_sec = 4;\nwindow_samples = window_sec * fs;\nnum_windows = floor(length(full_signal) / window_samples);\n\nalpha_power_time = zeros(1, num_windows);\ntheta_power_time = zeros(1, num_windows);\n\nfor w = 1:num_windows\n  % Extract window\n  % YOUR CODE HERE\n\n  % Compute power spectrum\n  % YOUR CODE HERE\n\n  % Extract alpha and theta power\n  % YOUR CODE HERE\nend\n\n% Plot\nfigure;\n% YOUR CODE HERE\n",
      "solution": "rng(44);\n\nfs = 256;\nphase_duration = 20;\n\nt1 = 0:1/fs:phase_duration-1/fs;\nphase1 = 8*sin(2*pi*10*t1) + 3*sin(2*pi*6*t1) + 6*sin(2*pi*20*t1) + 3*randn(1,length(t1));\n\nt2 = 0:1/fs:phase_duration-1/fs;\nphase2 = 16*sin(2*pi*10*t2) + 8*sin(2*pi*6*t2) + 6*sin(2*pi*20*t2) + 3*randn(1,length(t2));\n\nt3 = 0:1/fs:phase_duration-1/fs;\nphase3 = 24*sin(2*pi*10*t3) + 15*sin(2*pi*6*t3) + 6*sin(2*pi*20*t3) + 3*randn(1,length(t3));\n\nfull_signal = [phase1, phase2, phase3];\n\nwindow_sec = 4;\nwindow_samples = window_sec * fs;\nnum_windows = floor(length(full_signal) / window_samples);\n\nalpha_power_time = zeros(1, num_windows);\ntheta_power_time = zeros(1, num_windows);\n\nfor w = 1:num_windows\n  start_idx = (w-1) * window_samples + 1;\n  end_idx = w * window_samples;\n  segment = full_signal(start_idx:end_idx);\n\n  Nw = length(segment);\n  fft_seg = fft(segment);\n  power_seg = (abs(fft_seg(1:Nw/2+1)).^2) / Nw;\n  freqs = (0:Nw/2) * fs / Nw;\n\n  alpha_idx = freqs >= 8 & freqs <= 13;\n  theta_idx = freqs >= 4 & freqs < 8;\n\n  alpha_power_time(w) = sum(power_seg(alpha_idx));\n  theta_power_time(w) = sum(power_seg(theta_idx));\nend\n\nfigure;\nsubplot(2,1,1);\nbar(1:num_windows, alpha_power_time);\nxlabel('Window number');\nylabel('Alpha Power (uV^2)');\ntitle('Alpha Power (8-13 Hz) Over Meditation Session');\n\nsubplot(2,1,2);\nbar(1:num_windows, theta_power_time);\nxlabel('Window number');\nylabel('Theta Power (uV^2)');\ntitle('Theta Power (4-8 Hz) Over Meditation Session');\n\nsgtitle('Brain Wave Changes During Meditation');",
      "hints": [
        "Phase 2 and 3 follow the same pattern as phase 1 but with different amplitudes. phase2 = 16*sin(2*pi*10*t2) + 8*sin(2*pi*6*t2) + 6*sin(2*pi*20*t2) + 3*randn(1,length(t2)); Concatenate: full_signal = [phase1, phase2, phase3];",
        "In the loop: start_idx = (w-1)*window_samples + 1; end_idx = w*window_samples; segment = full_signal(start_idx:end_idx); Then compute FFT and power on the segment.",
        "freqs = (0:Nw/2)*fs/Nw; alpha_idx = freqs >= 8 & freqs <= 13; theta_idx = freqs >= 4 & freqs < 8; Use subplot(2,1,1) and subplot(2,1,2) for the two panels."
      ],
      "test_cases": [],
      "requires_plot": true
    }
  ]
}
